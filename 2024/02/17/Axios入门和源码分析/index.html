
<!DOCTYPE html>
<html lang="zh-Hans">
<head>
    <meta charset="utf-8" />
    <title>axios | 哈哈哈哈哈哈哈重生之我是兵王</title>
    <meta name="author" content="chenw" />
    <meta name="description" content="description" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	<canvas id="fireworks" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 32767"></canvas>
	<script src="https://cdn.staticfile.org/animejs/3.2.1/anime.min.js"></script>
	<script src="/js/fireworks.min.js"></script>
	<canvas id="background" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: -1"></canvas>
	<script src="/js/background.min.js"></script>
	<div id="cursor"></div>
	<link rel="stylesheet" href="/css/cursor.min.css">
	<script src="/js/cursor.min.js"></script>
    <link rel="icon" href="/images/avatar.jpg" />
    <link rel="preconnect" href="https://cdn.staticfile.org" />
<script src="https://cdn.staticfile.org/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.loli.net" />
<link rel="preconnect" href="https://gstatic.loli.net" crossorigin />
<link rel="stylesheet" href="https://fonts.loli.net/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap" />
<script> const mixins = {}; </script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


<script src="https://cdn.staticfile.org/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdn.staticfile.org/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://cdn.staticfile.org/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>



<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>哈哈哈哈哈哈哈重生之我是兵王</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;哈哈哈哈哈哈哈重生之我是兵王</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1>axios</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2024/2/17
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            
            <span class="tag">
                
                <a href="/tags/axios/" style="color: #00a596">axios</a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <p>摘要</p>
<span id="more"></span>
<p>正文</p>
<h1 id="axios入门-源码分析"><a href="#axios入门-源码分析" class="headerlink" title="axios入门&amp;源码分析"></a>axios入门&amp;源码分析</h1><p><strong>世之奇伟、瑰怪、非常之观,常在于险远</strong></p>
<p><strong>加油</strong>！！</p>
<p><strong>json-server</strong></p>
<p>快速搭建服务器</p>
<h2 id="认识axios"><a href="#认识axios" class="headerlink" title="认识axios"></a>认识axios</h2><p><strong>作用</strong></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240218111405810.png" alt="image-20240218111405810"></p>
<h2 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h2><pre><code class="html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
    &lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/axios/1.5.0/axios.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;../../jquery.js&quot;&gt;&lt;/script&gt;
    &lt;script&gt;
        $(()=&gt;&#123;
            $(&#39;#btn1&#39;).click(()=&gt;&#123;
                console.log(111)
                axios(&#123;
                    method:&quot;POST&quot;,
                    url:&#39;http://localhost:3000/posts&#39;,
                    data:&#123;
                        title:&#39;今天天气不错&#39;,
                        author:&#39;张三&#39;,

                    &#125;
                &#125;).then(value =&gt; &#123;
                    console.log(value)
                &#125;,error=&gt;&#123;
                    console.log(error)
                &#125;)
            &#125;)
        &#125;)
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;button id=&quot;btn1&quot;&gt;发送get请求&lt;/button&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240218115917400.png" alt="image-20240218115917400"></p>
<p>里面的配置</p>
<pre><code class="js">&#123;
  // `url` is the server URL that will be used for the request
  url: &#39;/user&#39;,

  // `method` is the request method to be used when making the request
  method: &#39;get&#39;, // default

  // `baseURL` will be prepended to `url` unless `url` is absolute.
  // It can be convenient to set `baseURL` for an instance of axios to pass relative URLs
  // to methods of that instance.
  baseURL: &#39;https://some-domain.com/api/&#39;,

  // `transformRequest` allows changes to the request data before it is sent to the server
  // This is only applicable for request methods &#39;PUT&#39;, &#39;POST&#39;, &#39;PATCH&#39; and &#39;DELETE&#39;
  // The last function in the array must return a string or an instance of Buffer, ArrayBuffer,
  // FormData or Stream
  // You may modify the headers object.
  transformRequest: [function (data, headers) &#123;
    // Do whatever you want to transform the data

    return data;
  &#125;],

  // `transformResponse` allows changes to the response data to be made before
  // it is passed to then/catch
  transformResponse: [function (data) &#123;
    // Do whatever you want to transform the data

    return data;
  &#125;],

  // `headers` are custom headers to be sent
  headers: &#123;&#39;X-Requested-With&#39;: &#39;XMLHttpRequest&#39;&#125;,

  // `params` are the URL parameters to be sent with the request
  // Must be a plain object or a URLSearchParams object
  params: &#123;
    ID: 12345
  &#125;,
  
  // `paramsSerializer` is an optional config that allows you to customize serializing `params`. 
  paramsSerializer: &#123;

    //Custom encoder function which sends key/value pairs in an iterative fashion.
    encode?: (param: string): string =&gt; &#123; /* Do custom operations here and return transformed string */ &#125;, 
    
    // Custom serializer function for the entire parameter. Allows user to mimic pre 1.x behaviour.
    serialize?: (params: Record&lt;string, any&gt;, options?: ParamsSerializerOptions ), 
    
    //Configuration for formatting array indexes in the params. 
    indexes: false // Three available options: (1) indexes: null (leads to no brackets), (2) (default) indexes: false (leads to empty brackets), (3) indexes: true (leads to brackets with indexes).    
  &#125;,

  // `data` is the data to be sent as the request body
  // Only applicable for request methods &#39;PUT&#39;, &#39;POST&#39;, &#39;DELETE , and &#39;PATCH&#39;
  // When no `transformRequest` is set, must be of one of the following types:
  // - string, plain object, ArrayBuffer, ArrayBufferView, URLSearchParams
  // - Browser only: FormData, File, Blob
  // - Node only: Stream, Buffer, FormData (form-data package)
  data: &#123;
    firstName: &#39;Fred&#39;
  &#125;,

  // syntax alternative to send data into the body
  // method post
  // only the value is sent, not the key
  data: &#39;Country=Brasil&amp;City=Belo Horizonte&#39;,

  // `timeout` specifies the number of milliseconds before the request times out.
  // If the request takes longer than `timeout`, the request will be aborted.
  timeout: 1000, // default is `0` (no timeout)

  // `withCredentials` indicates whether or not cross-site Access-Control requests
  // should be made using credentials
  withCredentials: false, // default

  // `adapter` allows custom handling of requests which makes testing easier.
  // Return a promise and supply a valid response (see lib/adapters/README.md).
  adapter: function (config) &#123;
    /* ... */
  &#125;,

  // `auth` indicates that HTTP Basic auth should be used, and supplies credentials.
  // This will set an `Authorization` header, overwriting any existing
  // `Authorization` custom headers you have set using `headers`.
  // Please note that only HTTP Basic auth is configurable through this parameter.
  // For Bearer tokens and such, use `Authorization` custom headers instead.
  auth: &#123;
    username: &#39;janedoe&#39;,
    password: &#39;s00pers3cret&#39;
  &#125;,

  // `responseType` indicates the type of data that the server will respond with
  // options are: &#39;arraybuffer&#39;, &#39;document&#39;, &#39;json&#39;, &#39;text&#39;, &#39;stream&#39;
  //   browser only: &#39;blob&#39;
  responseType: &#39;json&#39;, // default

  // `responseEncoding` indicates encoding to use for decoding responses (Node.js only)
  // Note: Ignored for `responseType` of &#39;stream&#39; or client-side requests
  // options are: &#39;ascii&#39;, &#39;ASCII&#39;, &#39;ansi&#39;, &#39;ANSI&#39;, &#39;binary&#39;, &#39;BINARY&#39;, &#39;base64&#39;, &#39;BASE64&#39;, &#39;base64url&#39;,
  // &#39;BASE64URL&#39;, &#39;hex&#39;, &#39;HEX&#39;, &#39;latin1&#39;, &#39;LATIN1&#39;, &#39;ucs-2&#39;, &#39;UCS-2&#39;, &#39;ucs2&#39;, &#39;UCS2&#39;, &#39;utf-8&#39;, &#39;UTF-8&#39;,
  // &#39;utf8&#39;, &#39;UTF8&#39;, &#39;utf16le&#39;, &#39;UTF16LE&#39;
  responseEncoding: &#39;utf8&#39;, // default

  // `xsrfCookieName` is the name of the cookie to use as a value for xsrf token
  xsrfCookieName: &#39;XSRF-TOKEN&#39;, // default

  // `xsrfHeaderName` is the name of the http header that carries the xsrf token value
  xsrfHeaderName: &#39;X-XSRF-TOKEN&#39;, // default
    
  // `undefined` (default) - set XSRF header only for the same origin requests
  withXSRFToken: boolean | undefined | ((config: InternalAxiosRequestConfig) =&gt; boolean | undefined),

  // `onUploadProgress` allows handling of progress events for uploads
  // browser &amp; node.js
  onUploadProgress: function (&#123;loaded, total, progress, bytes, estimated, rate, upload = true&#125;) &#123;
    // Do whatever you want with the Axios progress event
  &#125;,

  // `onDownloadProgress` allows handling of progress events for downloads
  // browser &amp; node.js
  onDownloadProgress: function (&#123;loaded, total, progress, bytes, estimated, rate, download = true&#125;) &#123;
    // Do whatever you want with the Axios progress event
  &#125;,

  // `maxContentLength` defines the max size of the http response content in bytes allowed in node.js
  maxContentLength: 2000,

  // `maxBodyLength` (Node only option) defines the max size of the http request content in bytes allowed
  maxBodyLength: 2000,

  // `validateStatus` defines whether to resolve or reject the promise for a given
  // HTTP response status code. If `validateStatus` returns `true` (or is set to `null`
  // or `undefined`), the promise will be resolved; otherwise, the promise will be
  // rejected.
  validateStatus: function (status) &#123;
    return status &gt;= 200 &amp;&amp; status &lt; 300; // default
  &#125;,

  // `maxRedirects` defines the maximum number of redirects to follow in node.js.
  // If set to 0, no redirects will be followed.
  maxRedirects: 21, // default

  // `beforeRedirect` defines a function that will be called before redirect.
  // Use this to adjust the request options upon redirecting,
  // to inspect the latest response headers,
  // or to cancel the request by throwing an error
  // If maxRedirects is set to 0, `beforeRedirect` is not used.
  beforeRedirect: (options, &#123; headers &#125;) =&gt; &#123;
    if (options.hostname === &quot;example.com&quot;) &#123;
      options.auth = &quot;user:password&quot;;
    &#125;
  &#125;,

  // `socketPath` defines a UNIX Socket to be used in node.js.
  // e.g. &#39;/var/run/docker.sock&#39; to send requests to the docker daemon.
  // Only either `socketPath` or `proxy` can be specified.
  // If both are specified, `socketPath` is used.
  socketPath: null, // default
  
  // `transport` determines the transport method that will be used to make the request. If defined, it will be used. Otherwise, if `maxRedirects` is 0, the default `http` or `https` library will be used, depending on the protocol specified in `protocol`. Otherwise, the `httpFollow` or `httpsFollow` library will be used, again depending on the protocol, which can handle redirects.
  transport: undefined, // default

  // `httpAgent` and `httpsAgent` define a custom agent to be used when performing http
  // and https requests, respectively, in node.js. This allows options to be added like
  // `keepAlive` that are not enabled by default.
  httpAgent: new http.Agent(&#123; keepAlive: true &#125;),
  httpsAgent: new https.Agent(&#123; keepAlive: true &#125;),

  // `proxy` defines the hostname, port, and protocol of the proxy server.
  // You can also define your proxy using the conventional `http_proxy` and
  // `https_proxy` environment variables. If you are using environment variables
  // for your proxy configuration, you can also define a `no_proxy` environment
  // variable as a comma-separated list of domains that should not be proxied.
  // Use `false` to disable proxies, ignoring environment variables.
  // `auth` indicates that HTTP Basic auth should be used to connect to the proxy, and
  // supplies credentials.
  // This will set an `Proxy-Authorization` header, overwriting any existing
  // `Proxy-Authorization` custom headers you have set using `headers`.
  // If the proxy server uses HTTPS, then you must set the protocol to `https`.
  proxy: &#123;
    protocol: &#39;https&#39;,
    host: &#39;127.0.0.1&#39;,
    // hostname: &#39;127.0.0.1&#39; // Takes precedence over &#39;host&#39; if both are defined
    port: 9000,
    auth: &#123;
      username: &#39;mikeymike&#39;,
      password: &#39;rapunz3l&#39;
    &#125;
  &#125;,

  // `cancelToken` specifies a cancel token that can be used to cancel the request
  // (see Cancellation section below for details)
  cancelToken: new CancelToken(function (cancel) &#123;
  &#125;),

  // an alternative way to cancel Axios requests using AbortController
  signal: new AbortController().signal,

  // `decompress` indicates whether or not the response body should be decompressed
  // automatically. If set to `true` will also remove the &#39;content-encoding&#39; header
  // from the responses objects of all decompressed responses
  // - Node only (XHR cannot turn off decompression)
  decompress: true, // default

  // `insecureHTTPParser` boolean.
  // Indicates where to use an insecure HTTP parser that accepts invalid HTTP headers.
  // This may allow interoperability with non-conformant HTTP implementations.
  // Using the insecure parser should be avoided.
  // see options https://nodejs.org/dist/latest-v12.x/docs/api/http.html#http_http_request_url_options_callback
  // see also https://nodejs.org/en/blog/vulnerability/february-2020-security-releases/#strict-http-header-parsing-none
  insecureHTTPParser: undefined, // default

  // transitional options for backward compatibility that may be removed in the newer versions
  transitional: &#123;
    // silent JSON parsing mode
    // `true`  - ignore JSON parsing errors and set response.data to null if parsing failed (old behaviour)
    // `false` - throw SyntaxError if JSON parsing failed (Note: responseType must be set to &#39;json&#39;)
    silentJSONParsing: true, // default value for the current Axios version

    // try to parse the response string as JSON even if `responseType` is not &#39;json&#39;
    forcedJSONParsing: true,

    // throw ETIMEDOUT error instead of generic ECONNABORTED on request timeouts
    clarifyTimeoutError: false,
  &#125;,

  env: &#123;
    // The FormData class to be used to automatically serialize the payload into a FormData object
    FormData: window?.FormData || global?.FormData
  &#125;,

  formSerializer: &#123;
      visitor: (value, key, path, helpers) =&gt; &#123;&#125;; // custom visitor function to serialize form values
      dots: boolean; // use dots instead of brackets format
      metaTokens: boolean; // keep special endings like &#123;&#125; in parameter key
      indexes: boolean; // array indexes format null - no brackets, false - empty brackets, true - brackets with indexes
  &#125;,

  // http adapter only (node.js)
  maxRate: [
    100 * 1024, // 100KB/s upload limit,
    100 * 1024  // 100KB/s download limit
  ]
&#125;
</code></pre>
<p>实例对象的使用</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240218130659829.png" alt="image-20240218130659829"></p>
<p>拦截器的执行过程</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240218131212665.png" alt="image-20240218131212665"></p>
<p>如果请求的时候抛出错误或者返回一个错误的promise</p>
<p>那么就会到响应拦截器错误守卫回调</p>
<p>然后请求的成功的回调也不会执行</p>
<p>如果设置多个</p>
<p>执行的顺序</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240218131551357.png" alt="image-20240218131551357"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240218131539004.png" alt="image-20240218131539004"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240218131511677.png" alt="image-20240218131511677"></p>
<p>总结：请求拦截器先进后出，响应拦截器先进先出</p>
<p>我们可以在请求拦截器里面</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240218131722658.png" alt="image-20240218131722658"></p>
<p>使用config对请求头做</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240218131804894.png" alt="image-20240218131804894"></p>
<p>还可以对响应结果做处理</p>
<p>取消发送的实现</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240218132154736.png" alt="image-20240218132154736"></p>

    </div>
    
    
    
    
    
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2024 哈哈哈哈哈哈哈重生之我是兵王
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;chenw
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    




    
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
